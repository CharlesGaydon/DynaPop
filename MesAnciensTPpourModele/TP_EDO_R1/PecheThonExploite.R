rm(list=ls())

#parms = c(r,K,E)
#Valeurs positives par defaut : r = 2, K = 300
Eq3 = function(t,x,parms){
  dx1 = parms[1]*x[1]*(1-(x[1]/parms[2])) - parms[3]*x[1]*x[1]
  list(dx1)
}

temps=seq(0,20,by=0.1)
init= c(50)
r = 2
K = 300
E=0.1


simulation1 = lsoda(init,temps,Eq3,parms=c(r,K,E))
plot(temps,simulation1[,2],ylim=c(0,60),
     main = "PecheExploite",
     ylab = "Densit√© de population (N)",
     lty=1,col=1,type= "l")

init=c(10)
simulation5 = lsoda(init,temps,Eq3,parms=c(r,K,E))


E=0.5
simulation2 = lsoda(init,temps,Eq3,parms=c(r,K,E))
E=1
simulation3 = lsoda(init,temps,Eq3,parms=c(r,K,E))

init=c(50)
E=5
simulation4 = lsoda(init,temps,Eq3,parms=c(r,K,E))




lines(temps,simulation2[,2],lty = 2,col=2)
lines(temps,simulation3[,2],lty = 1,col=3)
lines(temps,simulation4[,2],lty = 2,col=4)
lines(temps,simulation5[,2],lty = 2,col=5)
lines(temps,simulation6[,2],lty = 2,col=6)


x11()
E=0.1
curve(r*x*(1-x/K)-E*x*x,,xlim=c(-5,30),ylim=c(0,10),main = "E=0.1",ylab="dN/dt",xlab ="N")
E=0.2
curve(r*x*(1-x/K)-E*x*x,,xlim=c(-5,30),ylim=c(0,10),main = "E=0.2",ylab="dN/dt",xlab ="N",add=TRUE)
E = 0.5
curve(r*x*(1-x/K)-E*x*x,,xlim=c(-5,30),ylim=c(0,10),main = "E=0.5",ylab="dN/dt",xlab ="N",add=TRUE)
abline(h=0,lwd=3)
X2 = (r*K)/(r+E*K)
X2
